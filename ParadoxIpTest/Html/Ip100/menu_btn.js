var bypassbody=false;var vertical=false;var centrer_menu=false;var largeur_menu=95;var hauteur_menu=25;var largeur_sous_menu=110;var largeur_auto_ssmenu=true;var espace_entre_menus=5;var top_menu=0;var top_ssmenu=top_menu+28;var left_menu=0;var left_ssmenu=largeur_menu+2;var delai=650;var marge_en_haut_de_page=top_menu+40;var marge_a_gauche_de_la_page=largeur_menu+10;var suivre_le_scroll=true;var cacher_les_select=true;var nbmenu=0;var timeout;var timeout_roll;var agt=navigator.userAgent.toLowerCase();var isMac=(agt.indexOf('mac')!=-1);var isOpera=(agt.indexOf('opera')!=-1);var ieVer=parseInt(agt.substring(agt.indexOf('msie')+5));var isIE=((agt.indexOf('msie')!=-1&&!isOpera&&(agt.indexOf('webtv')==-1))&&!isMac);var isIE5win=(isIE&&ieVer>=5);var isIE5mac=((agt.indexOf('msie')!=-1)&&isMac);var isSafari=(agt.indexOf('safari')!=-1);var reg=new RegExp("px","g");window.onscroll=function(){if(suivre_le_scroll&&(isIE||isIE5mac)){if(isIE5mac){mainframe.formframe.document.getElementById("conteneurmenu").style.display="none";}var cumul=0;for(i=1;i<=nbmenu;i++){var scrollTop=(mainframe.formframe.document.documentElement&&mainframe.formframe.document.documentElement.scrollTop?mainframe.formframe.document.documentElement.scrollTop:mainframe.formframe.document.body.scrollTop);if(!vertical){mainframe.formframe.document.getElementById("menu"+i).style.top=scrollTop+top_menu+"px";if(mainframe.formframe.document.getElementById("ssmenu"+i)){mainframe.formframe.document.getElementById("ssmenu"+i).style.top=scrollTop+top_ssmenu+"px";}}else{mainframe.formframe.document.getElementById("menu"+i).style.top=scrollTop+(((i-1)*espace_entre_menus)+cumul+1+top_menu)+"px";if(mainframe.formframe.document.getElementById("ssmenu"+i)){mainframe.formframe.document.getElementById("ssmenu"+i).style.top=scrollTop+(((i-1)*espace_entre_menus)+cumul+1+top_menu)+"px";}cumul+=isFinite(hauteur_menu)?hauteur_menu:hauteur_menu[i-1];}}if(isIE5mac){mainframe.formframe.document.getElementById("conteneurmenu").style.display="block";}}};function preChargement(){if(mainframe.formframe.document.getElementById("conteneurmenu")){mainframe.formframe.document.getElementById("conteneurmenu").style.display="none";}}function Chargement(){if(mainframe.formframe.document.getElementById("conteneurmenu")){nbmenu=0;while(mainframe.formframe.document.getElementById("menu"+(nbmenu+1))){nbmenu++;}mainframe.formframe.document.getElementById("conteneurmenu").style.display="none";trimespaces();positionne_sousmenu();CacherMenus(0);mainframe.formframe.document.getElementById("conteneurmenu").style.display='block';}}function positionne_sousmenu(){var largeur_fenetre;if(mainframe.formframe.document.documentElement&&mainframe.formframe.document.documentElement.clientWidth){largeur_fenetre=mainframe.formframe.document.documentElement.clientWidth;}else if(mainframe.formframe.document.body&&mainframe.formframe.document.body.clientWidth){largeur_fenetre=mainframe.formframe.document.body.clientWidth;}else if(window.innerWidth){largeur_fenetre=window.innerWidth;}var hauteur_fenetre;if(mainframe.formframe.document.documentElement&&mainframe.formframe.document.documentElement.clientHeight){hauteur_fenetre=mainframe.formframe.document.documentElement.clientHeight;}else if(mainframe.formframe.document.body&&mainframe.formframe.document.body.clientHeight){hauteur_fenetre=mainframe.formframe.document.body.clientHeight;}else if(window.innerHeight){hauteur_fenetre=window.innerHeight;}cumul=0;for(i=1;i<=nbmenu;i++){if(mainframe.formframe.document.getElementById("ssmenu"+i)){with(mainframe.formframe.document.getElementById("ssmenu"+i).style){position="absolute";if(isIE||isOpera||isIE5mac||!largeur_auto_ssmenu){if(isFinite(largeur_sous_menu)){width=largeur_sous_menu+(largeur_sous_menu!="auto"?"px":"");}else{width=largeur_sous_menu[i-1]+(largeur_sous_menu[i-1]!="auto"?"px":"");}}else{width="auto";}width="120px";if(!vertical&&!isIE5mac){if((width!="auto")&&((left.replace(reg,'').valueOf()*1+width.replace(reg,'').valueOf()*1)>largeur_fenetre)){left=(largeur_fenetre-width.replace(reg,'').valueOf())+"px";}}margin="0";zIndex="0";top=findPos_top(mainframe.formframe.document.getElementById("menu"+i))+35;left=findPos_left(mainframe.formframe.document.getElementById("menu"+i))-(120-(mainframe.formframe.document.getElementById("menu"+i).offsetWidth));}}if((!vertical&&isFinite(largeur_menu))||(vertical&&isFinite(hauteur_menu))){cumul+=(!vertical?largeur_menu:hauteur_menu);}else{cumul+=(!vertical?largeur_menu[i-1]:hauteur_menu[i-1]);}}}function findPos_top(obj){var curtop=0;if(obj.offsetParent){curtop=obj.offsetTop;while(obj=obj.offsetParent){curtop+=obj.offsetTop;}}return curtop;}function findPos_left(obj){var curleft=0;if(obj.offsetParent){curleft=obj.offsetLeft;while(obj=obj.offsetParent){curleft+=obj.offsetLeft;}}return curleft;}function MontrerMenu(strMenu){bypassbody=true;AnnulerCacher();CacherMenus(0);if(mainframe.formframe.document.getElementById(strMenu)){with(mainframe.formframe.document.getElementById(strMenu).style){visibility="visible";}}SelectVisible("hidden",mainframe.formframe.document.getElementsByTagName('select'));}function CacherDelai(){timeout=setTimeout('CacherMenus(0)',delai);}function AnnulerCacher(){if(timeout){clearTimeout(timeout);}}function CacherMenus(frombody){if(frombody){if(bypassbody){bypassbody=false;return;}}for(i=1;i<=nbmenu;i++){if(mainframe.formframe.document.getElementById("ssmenu"+i)){with(mainframe.formframe.document.getElementById("ssmenu"+i).style){visibility="hidden";}}SelectVisible("visible",mainframe.formframe.document.getElementsByTagName('select'));top.tog_mnu=-1;}}function trimespaces(){if(isIE5win){for(i=1;i<=nbmenu;i++){if(mainframe.formframe.document.getElementById("ssmenu"+i)){with(mainframe.formframe.document.getElementById("ssmenu"+i)){innerHTML=innerHTML.replace(/<LI>|<\/LI>/g,"");}}}}}function SelectVisible(v,elem){var i;if(cacher_les_select&&(isIE||isIE5win)){for(i=0;i<elem.length;i++){elem[i].style.visibility=v;}}}function roll(img_name,img_src){mainframe.formframe.document[img_name].src=img_src;}